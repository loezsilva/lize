{% load static %}

<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Processar dados - Lize</title>
  <link href="{% static 'favicon/favicon.ico' %}" rel="shortcut icon" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
  <link href="{% static 'tw/full/output.css' %}" rel="stylesheet">
  <style>
    ::backdrop {
      background-color: #001737;
      opacity: 0.6;
    }
  </style>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app" class="flex flex-col h-screen">
    <header class="flex items-center justify-between border-b border-[#E5E7EA] px-[11.5rem] py-4">
      <a class="flex-none text-primary-600" href="/">
        <span class="sr-only">Lize</span>
        <svg width="52" height="32" viewBox="0 0 52 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M15.362 21.6376C13.5956 20.8193 11.5161 20.3893 9.87081 20.1636C8.22555 19.938 4.7732 19.7265 2.71343 20.1197C3.46911 12.9932 3.92787 4.67531 4.08972 1.44461C4.12465 0.746213 3.64726 0.110763 2.96959 0.0133674C2.19645 -0.0970939 1.5153 0.490845 1.47571 1.26645C1.34879 3.81419 0.417295 15.6561 0.00627239 20.8276C-0.0892059 22.0272 0.919138 23.0131 2.08933 22.8622C2.96261 22.7506 4.05595 22.6556 5.31812 22.6164C6.5803 22.5772 8.11378 22.671 8.60747 22.7173C11.4148 22.981 13.2801 23.601 14.3257 24.0571C14.937 24.3232 15.6449 24.0737 15.9663 23.481C16.3331 22.804 16.0524 21.956 15.362 21.6365V21.6376ZM13.6996 2.87095C14.4286 2.91699 15.0538 2.32674 15.1977 1.61019C15.351 0.849951 14.9971 1.41725e-09 14.0075 1.41725e-09C13.3458 1.41725e-09 12.638 0.495805 12.5507 1.43783C12.4811 2.17564 12.9577 2.82373 13.7008 2.87095H13.6996ZM48.6574 10.4645C48.9523 9.78699 49.7227 9.44167 50.3917 9.72983L50.3905 9.72864C51.07 10.0216 51.38 10.8182 51.0933 11.5029C49.9697 14.1797 47.5595 19.269 41.4359 19.269C40.6561 19.269 39.8904 19.1713 39.1596 18.9725C37.0326 18.3926 35.3449 16.9327 34.6421 14.8274C32.923 17.1447 30.8717 18.982 28.5826 19.8631C28.9987 21.4421 29.1385 23.2866 28.9311 25.3549C28.4847 29.8929 25.8728 32.3482 23.0546 31.96C20.5196 31.6111 18.7107 28.9938 19.3762 25.7681C20.2772 21.4183 22.6898 19.4119 25.015 18.2521C24.7527 17.8996 24.4753 17.6174 24.1921 17.3983C23.8203 17.1101 23.6035 16.66 23.635 16.1849L23.6944 15.2799C23.7481 14.4607 24.1991 13.7153 24.9077 13.3259C26.3157 12.5531 27.8472 11.0647 27.8472 8.24616C27.8472 7.09589 27.4346 6.5279 26.5837 6.32428C25.107 5.96705 23.1839 7.34595 21.8215 10.3002L21.7445 10.2633L21.8226 10.3014C21.7475 10.4614 21.6524 10.6789 21.5381 10.9404C20.4805 13.3593 17.7795 19.5366 14.0487 18.7081C12.5521 18.3795 11.6337 17.1506 11.5358 15.4228C11.4029 13.1044 12.15 5.92895 12.1932 5.54315C12.2771 4.80488 12.9391 4.27261 13.657 4.35358C14.375 4.43455 14.8832 5.11566 14.8261 5.85036C14.721 7.20467 14.6146 8.39185 14.5201 9.446C14.3546 11.2929 14.2256 12.7314 14.2048 13.9451C14.1827 15.2549 15.0615 16.3207 16.3925 14.4333C17.4473 12.9377 18.6967 10.7682 19.452 9.16065C20.9298 5.95515 23.6816 2.87109 27.1851 3.71891C29.4369 4.25951 30.4404 6.26117 30.4707 8.20567C30.5115 10.8349 28.9847 14.0939 26.3308 15.7431C26.8064 16.2087 27.2294 16.7612 27.5872 17.384C29.874 16.5159 32.2679 14.0356 34.1269 10.761C34.5057 10.0942 34.8239 9.39404 35.113 8.68197C35.1444 8.60219 35.1782 8.52241 35.212 8.44263C37.0162 4.24522 40.1258 2.60913 42.6958 3.74868C44.9009 4.72629 45.8928 7.4936 44.7075 10.1811C43.6154 12.6448 40.3414 14.1654 36.881 12.5222C36.8706 15.1085 38.7668 16.5921 41.4382 16.5921C45.8415 16.5921 47.5257 13.0663 48.6574 10.4645ZM41.6527 6.2052C40.9394 5.88965 39.1433 5.95634 37.613 9.51907H37.6142C37.5741 9.61297 37.5695 9.62227 37.5655 9.63178C37.5606 9.643 37.5565 9.65451 37.4953 9.80604C40.0069 11.3254 41.81 10.2252 42.3193 9.07611C43.0023 7.52575 42.359 6.51837 41.6527 6.2052ZM23.4054 29.3082C24.2457 29.4237 25.9555 28.8379 26.325 25.0846C26.4963 23.3747 26.3809 21.897 26.0896 20.7002C24.3599 21.5635 22.6466 22.9281 21.9427 26.323C21.5359 28.2949 22.5487 29.1903 23.4054 29.3082Z" fill="#FF8F3D"/>
        </svg>
      </a>
      <nav aria-label="Progress">
        <ol role="list" class="space-x-6 divide-y divide-gray-300 md:flex md:divide-y-0">
          <li class="relative md:flex md:flex-1">
            <a href="#" class="group flex w-full items-center">
              <span class="flex items-center text-sm text-[#667085]">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary-600 group-hover:bg-primary-800">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 3L4.5 8.5L2 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="ml-3">Usuários</span>
              </span>
            </a>
          </li>
          <li class="relative md:flex md:flex-1">
            <a href="#" class="group flex w-full items-center">
              <span class="flex items-center text-sm text-[#667085]">
                <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-primary-600 group-hover:bg-primary-800">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 3L4.5 8.5L2 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="ml-3">Segmentos</span>
              </span>
            </a>
          </li>
          <li class="relative md:flex md:flex-1">
            <a href="#" class="flex items-center text-sm font-semibold" aria-current="step">
              <span class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-[#FFF2E9] border border-[#FFE0C9]">
                <span class="text-primary-600">3</span>
              </span>
              <span class="ml-3 text-[#384250]">Permissões</span>
            </a>
          </li>
        </ol>
      </nav>
    </header>
    <main class="h-full overflow-y-auto">
      <div class="bg-[#F9FAFA]">
        <div class="flex flex-col gap-4 px-[11.5rem] py-10">
          <div class="flex gap-8">
            <h1 class="text-3xl leading-[2.125rem] font-medium tracking-[-0.01em] text-[#101828]">Permissões</h1>
            <span class="flex items-center gap-2">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_864_1725)">
                  <path d="M10.0003 4.99999V9.99999L13.3337 11.6667M18.3337 9.99999C18.3337 14.6024 14.6027 18.3333 10.0003 18.3333C5.39795 18.3333 1.66699 14.6024 1.66699 9.99999C1.66699 5.39762 5.39795 1.66666 10.0003 1.66666C14.6027 1.66666 18.3337 5.39762 18.3337 9.99999Z" stroke="#D2D6DB" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
                <defs>
                  <clipPath id="clip0_864_1725">
                    <rect width="20" height="20" fill="white"/>
                  </clipPath>
                </defs>
              </svg>
              <span class="text-sm text-[#9BA3AF]">Tempo médio: </span><span class="text-sm font-semibold text-[#9BA3AF]">3 min</span>
            </span>
          </div>
          <div class="flex justify-between items-center">
            <p class="text-sm text-[#667085]">
              Anexe as planilhas que você possui referente aos perfis de usuários abaixo identificados. É importante que a planilha<br /> esteja atualizada para que o sistema possa identificar corretamente os dados. Assista ao vídeo ao lado.
            </p>
            <button id="buttonWatchVideo" type="button" class="flex items-center gap-3 text-start bg-white rounded-full border border-[#E5E7EA] px-4 py-2">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.33301 3.32642C3.33301 2.67898 3.33301 2.35526 3.468 2.17681C3.5856 2.02135 3.76536 1.92515 3.95994 1.91353C4.1833 1.9002 4.45265 2.07977 4.99135 2.4389L12.0017 7.11248C12.4469 7.40923 12.6694 7.55761 12.747 7.74462C12.8148 7.90813 12.8148 8.09188 12.747 8.25538C12.6694 8.4424 12.4469 8.59077 12.0017 8.88752L4.99135 13.5611C4.45265 13.9202 4.1833 14.0998 3.95994 14.0865C3.76536 14.0749 3.5856 13.9787 3.468 13.8232C3.33301 13.6447 3.33301 13.321 3.33301 12.6736V3.32642Z" stroke="#FF8F3D" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span class="text-xs leading-[0.875rem] font-medium text-[#384250]">
                Assista ao vídeo <br />explicativo
              </span>
            </button>
          </div>
        </div>
      </div>
      <div class="px-[11.5rem] py-10">
        <div class="flex justify-between">
          <p class="text-xs leading-[1.125rem] text-[#6C727F]">Lista de grupos de permissões</p>
          <button type="button" class="inline-flex gap-2 text-sm text-[#667085]" @click="openModalAddGroup">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_936_3150)">
                <path d="M10.0003 6.6665V13.3332M6.66699 9.99984H13.3337M18.3337 9.99984C18.3337 14.6022 14.6027 18.3332 10.0003 18.3332C5.39795 18.3332 1.66699 14.6022 1.66699 9.99984C1.66699 5.39746 5.39795 1.6665 10.0003 1.6665C14.6027 1.6665 18.3337 5.39746 18.3337 9.99984Z" stroke="#FF8F3D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </g>
              <defs>
                <clipPath id="clip0_936_3150">
                  <rect width="20" height="20" fill="white"/>
                </clipPath>
              </defs>
            </svg>
            Adicionar grupo
          </button>
        </div>
        <div class="flex flex-col gap-2 mt-6">
          {% for group in groups %}
            <div class="flex justify-between items-center rounded-xl border border-[#E5E7EA] p-6">
              <div>
                <div class="flex justify-center items-center gap-3">
                  <div class="flex justify-center items-center">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M10.0003 12.9167H6.25033C5.08736 12.9167 4.50587 12.9167 4.03271 13.0602C2.96737 13.3834 2.13369 14.217 1.81053 15.2824C1.66699 15.7555 1.66699 16.337 1.66699 17.5M13.3337 15L15.0003 16.6667L18.3337 13.3333M12.0837 6.25C12.0837 8.32107 10.4047 10 8.33366 10C6.26259 10 4.58366 8.32107 4.58366 6.25C4.58366 4.17893 6.26259 2.5 8.33366 2.5C10.4047 2.5 12.0837 4.17893 12.0837 6.25Z" stroke="#E5E7EA" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                  </div>
                  <div class="flex gap-5">
                    <p class="w-36 text-sm font-semibold text-[#384250]">{{ group.name }}</p>
                    <div class="flex items-center gap-2">
                      <span class="bg-[#FFF2E9] border border-[#FFE0C9] rounded px-1 py-0.5">
                        <p class="text-xs font-medium text-[#667085] text-center">
                          {{ group.permissions.count }} Permissões
                        </p>
                      </span>
                      <span class="bg-[#FFF2E9] border border-[#FFE0C9] rounded px-1 py-0.5">
                        <p class="text-xs font-medium text-[#667085] text-center">
                          {{ group.get_segment_display }}
                        </p>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex justify-center items-center">
                <div class="flex items-center gap-6">
                  <div class="flex items-center gap-4 text-sm leading-4">
                    <!-- <button type="button" class="relative cursor-pointer rounded-md bg-white font-semibold text-primary-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-600 focus-within:ring-offset-2 hover:text-primary-500">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.4997 17.4999H10.833M2.08301 17.9166L6.7074 16.138C7.00318 16.0242 7.15107 15.9673 7.28944 15.8931C7.41234 15.8271 7.52951 15.751 7.63971 15.6654C7.76378 15.5692 7.87582 15.4571 8.09991 15.233L17.4997 5.83326C18.4202 4.91279 18.4202 3.4204 17.4997 2.49993C16.5792 1.57945 15.0868 1.57945 14.1664 2.49992L4.76658 11.8997C4.54249 12.1238 4.43044 12.2358 4.33417 12.3599C4.24865 12.4701 4.17251 12.5873 4.10654 12.7102C4.03226 12.8485 3.97538 12.9964 3.86162 13.2922L2.08301 17.9166ZM2.08301 17.9166L3.79811 13.4574C3.92084 13.1383 3.9822 12.9787 4.08746 12.9057C4.17944 12.8418 4.29326 12.8176 4.40325 12.8386C4.52912 12.8627 4.64999 12.9836 4.89174 13.2253L6.77432 15.1079C7.01607 15.3496 7.13694 15.4705 7.16098 15.5964C7.18198 15.7064 7.15783 15.8202 7.09396 15.9122C7.02088 16.0174 6.86133 16.0788 6.54223 16.2015L2.08301 17.9166Z" stroke="#D3D6DB" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button> -->
                    <!-- <button type="button" class="relative cursor-pointer rounded-md bg-white font-semibold text-primary-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-600 focus-within:ring-offset-2 hover:text-primary-500">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.5 2.5H12.5M2.5 5H17.5M15.8333 5L15.2489 13.7661C15.1612 15.0813 15.1174 15.7389 14.8333 16.2375C14.5833 16.6765 14.206 17.0294 13.7514 17.2497C13.235 17.5 12.5759 17.5 11.2578 17.5H8.74221C7.42409 17.5 6.76503 17.5 6.24861 17.2497C5.79396 17.0294 5.41674 16.6765 5.16665 16.2375C4.88259 15.7389 4.83875 15.0813 4.75107 13.7661L4.16667 5" stroke="#D3D6DB" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button> -->
                    <!-- <button type="button" class="relative cursor-pointer rounded-md bg-white font-semibold text-primary-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-600 focus-within:ring-offset-2 hover:text-primary-500">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.25 2.5H12.1667C14.0335 2.5 14.9669 2.5 15.68 2.86331C16.3072 3.18289 16.8171 3.69282 17.1367 4.32003C17.5 5.03307 17.5 5.96649 17.5 7.83333V13.75M5.16667 17.5H11.9167C12.8501 17.5 13.3168 17.5 13.6733 17.3183C13.9869 17.1586 14.2419 16.9036 14.4017 16.59C14.5833 16.2335 14.5833 15.7668 14.5833 14.8333V8.08333C14.5833 7.14991 14.5833 6.6832 14.4017 6.32668C14.2419 6.01308 13.9869 5.75811 13.6733 5.59832C13.3168 5.41667 12.8501 5.41667 11.9167 5.41667H5.16667C4.23325 5.41667 3.76654 5.41667 3.41002 5.59832C3.09641 5.75811 2.84144 6.01308 2.68166 6.32668C2.5 6.6832 2.5 7.14991 2.5 8.08333V14.8333C2.5 15.7668 2.5 16.2335 2.68166 16.59C2.84144 16.9036 3.09641 17.1586 3.41002 17.3183C3.76654 17.5 4.23325 17.5 5.16667 17.5Z" stroke="#D3D6DB" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button> -->
                  </div>
                  <div>
                    <div class="flex items-center justify-center space-x-4">
                      {% if group.default %}
                        <span data-toggle="tooltip" data-placement="top" title="Grupo marcado como padrão para o segmento" class="rounded-full p-2 text-primary-600 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#ffdec7]" style="background-color: rgba(65, 197, 136, 0.1);">
                          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" class="h-5 w-5">
                            <path d="M22 11.0857V12.0057C21.9988 14.1621 21.3005 16.2604 20.0093 17.9875C18.7182 19.7147 16.9033 20.9782 14.8354 21.5896C12.7674 22.201 10.5573 22.1276 8.53447 21.3803C6.51168 20.633 4.78465 19.2518 3.61096 17.4428C2.43727 15.6338 1.87979 13.4938 2.02168 11.342C2.16356 9.19029 2.99721 7.14205 4.39828 5.5028C5.79935 3.86354 7.69279 2.72111 9.79619 2.24587C11.8996 1.77063 14.1003 1.98806 16.07 2.86572M22 4L12 14.01L9 11.01" stroke="#41C588" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                        </span>
                      {% else %}
                        <span data-toggle="tooltip" data-placement="top" title="O grupo não é padrão para o segmento" class="rounded-full p-2 text-primary-600 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#ffdec7]" style="background-color: rgb(249, 250, 250);">
                          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" class="h-5 w-5">
                            <path d="M22 11.0857V12.0057C21.9988 14.1621 21.3005 16.2604 20.0093 17.9875C18.7182 19.7147 16.9033 20.9782 14.8354 21.5896C12.7674 22.201 10.5573 22.1276 8.53447 21.3803C6.51168 20.633 4.78465 19.2518 3.61096 17.4428C2.43727 15.6338 1.87979 13.4938 2.02168 11.342C2.16356 9.19029 2.99721 7.14205 4.39828 5.5028C5.79935 3.86354 7.69279 2.72111 9.79619 2.24587C11.8996 1.77063 14.1003 1.98806 16.07 2.86572M22 4L12 14.01L9 11.01" stroke="#374151A1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                        </span>
                      {% endif %}
                    </div>
                    <!-- Enabled: "bg-primary-600", Not Enabled: "bg-gray-200" -->
                    <!-- <button type="button" class="relative inline-flex items-center h-[1.2rem] w-8 flex-shrink-0 cursor-not-allowed rounded-full border-2 border-transparent bg-primary-600 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary-600 focus:ring-offset-2" role="switch" aria-checked="false"> -->
                      <!-- <span class="sr-only">Padrão</span> -->
                      <!-- Enabled: "translate-x-3.5", Not Enabled: "translate-x-0" -->
                      <!-- <span aria-hidden="true" class="pointer-events-none inline-block h-[0.8rem] w-[0.8rem] translate-x-3.5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span> -->
                    <!-- </button> -->
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
      <dialog id="modal2" class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:w-full sm:max-w-[45.5rem] sm:p-6">
        <div>
          <form method="dialog" class="absolute right-0 top-0 hidden pr-6 pt-6 sm:block">
            <button type="submit" class="rounded-md bg-white text-[#D0D3D9] hover:text-[#BEC2CA] focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
              <span class="sr-only">Fechar</span>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </form>
          <div>
            <div>
              <h3 class="text-2xl font-medium text-[#101928]" id="modal-title">
                Veja o vídeo explicativo
              </h3>
            </div>
            <div class="mt-4">
              <iframe class="rounded" width="680" height="382.50" src="https://www.youtube.com/embed/YC8TVAtt5Og?si=6RX6LKTMhqZYFiQO" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture;" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
          </div>
        </div>
      </dialog>
      <dialog id="modalAddGroup" class="relative transform rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:w-full sm:max-w-[45.5rem] sm:p-6">
        <div>
          <form method="dialog" class="absolute right-0 top-0 hidden pr-6 pt-6 sm:block">
            <button type="submit" class="rounded-md bg-white text-[#D0D3D9] hover:text-[#BEC2CA] focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
              <span class="sr-only">Fechar</span>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </form>
          <form>
            <div class="space-y-12">
              <div class="border-b border-gray-900/10 pb-12">
                <h2 class="text-base font-semibold leading-7 text-gray-900">Adicionar grupo</h2>
                <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
                  <div class="sm:col-span-3">
                    <label for="name" class="block text-sm font-medium leading-6 text-gray-900">Nome</label>
                    <div class="mt-2">
                      <input type="text" name="name" id="name" autocomplete="given-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-primary-600 sm:text-sm sm:leading-6" v-model="modalAddGroupData.name">
                    </div>
                  </div>
                  <div class="sm:col-span-3">
                    <label for="segment" class="block text-sm font-medium leading-6 text-gray-900">Segmento</label>
                    <div class="mt-2">
                      <select id="segment" name="segment" v-model="modalAddGroupData.segment" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-primary-600 sm:max-w-xs sm:text-sm sm:leading-6" @change="handleChangeSegment">
                        <option value="">---</option>
                        <option value="coordination">Coordenações</option>
                        <option value="teacher">Professores</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-span-full">
                    <div class="relative flex items-start">
                      <div class="flex h-6 items-center">
                        <input id="default" name="default" aria-describedby="default-description" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600" v-model="modalAddGroupData.default" />
                      </div>
                      <div class="ml-3 text-sm leading-6">
                        <label for="default" class="font-medium text-gray-900">Grupo padrão para o segmento</label>
                        <p id="default-description" class="text-gray-500">Ao habilitar esta opção, qualquer usuário criado neste segmento será automaticamente adicionado a este grupo.</p>
                      </div>
                    </div>
                  </div>
                  <div
                    class="col-span-full"
                    v-if="modalAddGroupData.permissionsGroup.length > 0"
                  >
                    <div>
                      <h2 class="text-base font-semibold leading-7 text-gray-900">Permissões</h2>
                      <p class="mt-1 text-sm leading-6 text-gray-600">Defina as permissões que serão atribuídas aos membros do grupo para controlar e acessar funções no sistema.</p>
                      <div class="mt-4 space-y-6">
                        <fieldset v-for="permissionGroup in modalAddGroupData.permissionsGroup">
                          <legend class="text-sm font-semibold leading-6 text-gray-900">
                            [[ permissionGroup.name ]]
                          </legend>
                          <div class="mt-2 flex gap-2">
                            <button type="button" class="rounded-md bg-white px-2 py-1 text-xs text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" @click="selectAllPermissionsFromPermissionGroup(permissionGroup)">
                              Selecionar todas
                            </button>
                            <button type="button" class="rounded-md bg-white px-2 py-1 text-xs text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" @click="removeAllPermissionsFromPermissionGroup(permissionGroup)">
                              Remover todas
                            </button>
                          </div>
                          <div class="mt-3 space-y-2">
                            <div
                              class="relative flex gap-x-3"
                              v-for="permission in permissionGroup.permissions"
                            >
                              <div class="flex h-6 items-center">
                                <input :id="permission.key + '-permission'" name="permissions" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600" v-model="permission.checked" />
                              </div>
                              <div class="text-sm leading-6">
                                <label :for="permission.key + '-permission'" class="font-medium text-gray-900">
                                  [[ permission.value ]]
                                </label>
                              </div>
                            </div>
                          </div>
                        </fieldset>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="mt-6 flex items-center justify-end gap-x-6">
              <button
                type="button"
                class="flex items-center justify-center gap-4 w-full rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"
                :disabled="status === 'loading'"
                @click="saveGroup"
              >
                [[ status !== 'loading' ? 'Salvar' : 'Salvando...' ]]
                <svg class="animate-spin" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" v-if="status === 'loading'">
                  <g clip-path="url(#clip0_864_1942)">
                    <path d="M10.0001 1.66669V5.00002M10.0001 15V18.3334M5.00008 10H1.66675M18.3334 10H15.0001M15.8988 15.8987L13.5417 13.5417M15.8988 4.16664L13.5417 6.52366M4.10139 15.8987L6.45841 13.5417M4.10139 4.16664L6.45841 6.52366" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </g>
                  <defs>
                    <clipPath id="clip0_864_1942">
                      <rect width="20" height="20" fill="white"/>
                    </clipPath>
                  </defs>
                </svg>
              </button>
            </div>
          </form>
        </div>
      </dialog>
    </main>
    <footer class="flex justify-between border-t border-[#E5E7EA] px-[11.5rem] py-4">
      <a href="{% url 'onboarding:detail-segments' 5 %}" class="flex items-center gap-2 rounded-lg text-[#667085] py-3 text-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.5 5L7.5 10L12.5 15" stroke="#FF8F3D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Voltar
      </a>
      <a
        href="{% url 'onboarding:detail' 7 %}"
        class="flex items-center gap-4 rounded-lg bg-primary-600 text-white px-[8.375rem] py-3 text-sm font-semibold hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"
      >
        Continuar
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.1665 10H15.8332M15.8332 10L9.99984 4.16669M15.8332 10L9.99984 15.8334" stroke="white" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
    </footer>
  </div>
  <script>
    // let dialog2 = document.getElementById("modal2");
    // let dialogAddGroup = document.getElementById("modalAddGroup");

    // let buttonWatchVideo = document.getElementById("buttonWatchVideo");
    // let buttonAddGroup = document.getElementById("buttonAddGroup");

    // dialog2.addEventListener("click", function onClick(event) {
    //   if (event.target === dialog2) {
    //     dialog2.close();
    //   }
    // });
    // dialogAddGroup.addEventListener("click", function onClick(event) {
    //   if (event.target === dialogAddGroup) {
    //     dialogAddGroup.close();
    //   }
    // });

    // buttonWatchVideo.addEventListener("click", function onClick(event) {
    //   dialog2.showModal();
    // });
    // buttonAddGroup.addEventListener("click", function onClick(event) {
    //   dialogAddGroup.showModal();
    // });

    //////////////////////////////////////////////////////////////////////
    /// VUE
    //////////////////////////////////////////////////////////////////////

    const { createApp } = Vue

    const app = createApp({
      data() {
        return {
          status: 'idle',
          modalAddGroupData: {
            name: '',
            segment: '',
            default: false,

            permissionsGroupStatus: 'idle',
            permissionsGroup: [],
          },
        }
      },
      methods: {
        openModalAddGroup() {
          const dialog = document.getElementById('modalAddGroup');
          dialog.showModal();
        },
        async handleChangeSegment() {
          console.log('handleChangeSegment')
          console.log(this.modalAddGroupData.segment)

          this.modalAddGroupData.permissionsGroupStatus = 'loading'

          try {
            const res = await fetch(`{% url 'api2:permissions-permissions' %}${this.modalAddGroupData.segment}`)
            const data = await res.json()

            const permissionsGroup = Object.values(data).map(item => {
              return { name: item.name, permissions: Object.entries(item.permissions).map(([key, value]) => ({ key, value, checked: false })) }
            })
            console.log(permissionsGroup)
            this.modalAddGroupData.permissionsGroup = permissionsGroup
            this.modalAddGroupData.permissionsGroupStatus = 'success'
          } catch (error) {
            console.error(error)
            this.modalAddGroupData.permissionsGroupStatus = 'error'
          }
        },
        selectAllPermissionsFromPermissionGroup(permissionGroup) {
          permissionGroup.permissions.forEach(permission => {
            permission.checked = true
          })
        },
        removeAllPermissionsFromPermissionGroup(permissionGroup) {
          permissionGroup.permissions.forEach(permission => {
            permission.checked = false
          })
        },
        async saveGroup() {
          if (this.status === 'loading') return
          this.status = 'loading'

          try {
            const response = await fetch("{% url 'api2:permissions-create-update-group' %}", {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                name: this.modalAddGroupData.name,
                segment: this.modalAddGroupData.segment,
                default: this.modalAddGroupData.default,
                permissions: this.modalAddGroupData.permissionsGroup.flatMap(group =>
                  group.permissions.filter(permission => permission.checked).map(permission => permission.key)
                ),
              }),
            })
            const data = await response.json()
            this.status = 'success'
            const dialog = document.getElementById('modalAddGroup');
            dialog.close();
            window.location.reload();
          } catch (error) {
            console.log('error', error)
            this.status = 'error'
          }
        },
      },
      mounted() {
        const dialogs = document.querySelectorAll('dialog');

        function closeOnClickOutside(event) {
          const dialog = event.target;
          if (dialog instanceof HTMLDialogElement) {
            dialog.close();
          }
        }

        dialogs.forEach(dialog => {
          dialog.addEventListener('click', closeOnClickOutside);
        });
      },
    });
    app.config.compilerOptions.delimiters = ['[[', ']]'];
    app.mount('#app');
  </script>
</body>
</html>
